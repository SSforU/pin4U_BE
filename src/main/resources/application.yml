spring:
  application:
    name: pin4U
  profiles:
    default: local  # 명시하지 않으면 항상 local로 동작

springdoc:
  swagger-ui:
    path: /swagger-ui.html
  api-docs:
    enabled: true

# (참고) 아래 커스텀 'cors.allowed-origins' 같은 비표준 키는 사용하지 않습니다.
#cors:
#  allowed-origins: "http://localhost:3000"

app:
  cookies:
    crossSite: true   # 운영: true (교차 출처 쿠키 → SameSite=None; Secure)
    domain: ""        # Host-Only 권장. 공유 필요 시 ".ss4u-pin4u.store"
  kakao:
    enabled: ${APP_KAKAO_ENABLED:true}
    rest-api-key: ${KAKAO_REST_API_KEY:}
    api:
      base-url: https://dapi.kakao.com
  seed:
    enabled: false
  og:
    image-enabled: false
  summary:
    ttl-days: 7
  ai:
    enabled: ${APP_AI_ENABLED:true}
    openai:
      base_url: https://api.openai.com/v1
      model: ${OPENAI_MODEL:gpt-4o-mini}
      timeout_ms: 8000

# 프록시/ALB 뒤에서 X-Forwarded-* 헤더를 인지하여 HTTPS 판별 정확도 확보
server:
  forward-headers-strategy: framework

resilience4j:
  retry:
    instances:
      kakaoSearch:
        max-attempts: 3
        wait-duration: 300ms
  timelimiter:
    instances:
      kakaoSearch:
        timeout-duration: 2s
  circuitbreaker:
    instances:
      kakaoSearch:
        sliding-window-type: COUNT_BASED
        sliding-window-size: 20
        failure-rate-threshold: 50
  ratelimiter:
    instances:
      kakaoSearch:
        limit-for-period: 10
        limit-refresh-period: 1s

management:
  endpoints:
    web:
      exposure:
        include: health,info,mappings
  endpoint:
    flyway:
      enabled: true
